---
- name: "Check network configuration is correct - /etc/sysconfig" 
  shell: ls -l /etc/sysconfig/network-scripts/ifcfg-* | grep -q {{ item }}
  with_items:
      - bond0
      - em1
      - em2
      - macvlan-bond0

- name: "Check network configuration is correct - MACADDR" 
  shell: grep MACADDR /etc/sysconfig/network-scripts/ifcfg-macvlan-bond0

- name: "Check network configuration is correct - ifconfig"
  shell: ifconfig {{ item }}
  with_items: 
      - bond0
      - em1
      - em2
      - macvlan-bond0

- name: "Check that vmstat is running"
  shell: service vmstat status | grep "active"

- name: "Verify server info is available via arventory"
  shell: arventory list -l {{ansible_hostname}} | grep -q "{{ansible_hostname}}" 

- name: "Delete cron job calling ASB"
  file:
     path: /etc/cron.d/ASB
     state: absent

- name: "Update datacenter.servers with status for this machine as installed"
  command: >
      mysql -u arastra -e
      "UPDATE {{ASB_DB}} SET status=\"{{ASB_STATUS_INSTALLED}}\" WHERE\
       name=\"{{ansible_hostname}}\" AND domain=\"{{ASB_DEFAULT_DOMAIN}}\""
      -h mysql datacenter

- name: "Send Thomas email -- TODO this goes to ME at the moment"
  shell: "echo \"{{ASB_MAIL_BODY}}\" | mail -s \"{{ASB_MAIL_HEADER}}\" ren@arista.com"
...
